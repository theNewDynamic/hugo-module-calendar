{{/*
  GetURLOutlook

  Description
  Returns an Outlook calendar event URL

  @author mountainbug95

  @context Page (.)

  @access private

  @return String

  @example - Go Template
    {{ with partial "tnd-addtocal/private/calendar-btn/GetURLOutlook" . }}
      <li class="ateoutlookcom" id="addeventatc1-outlookcom" role="menuitem"><a href="{{ htmlUnescape . }}"> <strong>Outlook.com</strong><em>(online)</em></a></li>
    {{ end }}
*/}}
{{ $fullLink := false }}
{{ $config := partialCached "tnd-addtocal/private/GetConfig" . }}
{{ with .Date }}


  {{ $hour := add (div (int (print ((dateFormat "15" .) | strings.TrimLeft "0") "0")) 10) 6 }}
  {{ $startHour := add (div (int (print ((dateFormat "15" .) | strings.TrimLeft "0") "0")) 10) 5 }}
  {{ $minute := div (int (print ((dateFormat "04" .) | strings.TrimLeft "0") "0")) 10 }}
  {{ $second := div (int (print ((dateFormat "05" .) | strings.TrimLeft "0") "0")) 10 }}

  {{ if lt $hour 10 }}
    {{ $hour = print "0" (string $hour) }}
  {{ else }}
    {{ $hour = string $hour }}
  {{ end }}

  {{ if lt $startHour 10 }}
    {{ $startHour = print "0" (string $startHour) }}
  {{ else }}
    {{ $startHour = string $startHour }}
  {{ end }}

  {{ if lt $minute 10 }}
    {{ $minute = print "0" (string $minute) }}
  {{ else }}
    {{ $minute = string $minute }}
  {{ end }}

  {{ if lt $second 10 }}
    {{ $second = print "0" (string $second) }}
  {{ else }}
    {{ $second = string $second }}
  {{ end }}

  {{ $date := print (dateFormat "20060102" .) "T" $startHour $minute $second "Z" }}
  {{ $endDate := print (dateFormat "20060102" .) "T" $hour $minute $second "Z" }}

  {{ $eventTitle := $.Params.title }}

  {{ $eventContent := "" }}

  {{ $variant := printf "%x" (dict "variant" $.Params "showContent" true) }}
  {{ with partialCached "tnd-addtocal/private/calendar-btn/GetCalendarContent" (dict "context" $ "displayContent" true) $variant }}
    {{ $eventContent = . }}
  {{ end }}

  {{ $link := querify "rru" "addevent" "startdt" $date "enddt" $endDate "subject" $eventTitle "body" $eventContent "location" $config.default_location }}

  {{ $linkStart := "https://outlook.live.com/owa/?path=/calendar/view/Month&" }}

  {{ $fullLink =  print $linkStart $link }}
{{ else }}
  {{ warnf "%sThere is no 'date' parameter present in this event file." "\nHugo Module TND addtocal:\n" }}
{{ end }}

{{ return $fullLink }}